<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>First game</title>
	</head>
	<body>
		<h1>Enter your name:</h1>
		<form>
			<input type="text" id="name" placeholder="Your name here" />
			<button type="button" onclick="redirectToPage()">Submit</button>
		</form>

		<h2>Connected Users:</h2>
		<ul id="user-list"></ul>

		<script src="https://cdn.socket.io/4.3.1/socket.io.min.js"></script>
		<script>
			const name = window.location.search.split('=')[1];

			const socket = io('http://142.93.164.123:3000', {query: {
			  username: name,
			} });
			const userList = document.getElementById('user-list');

			function redirectToPage() {
			  const name = document.getElementById('name').value;
			  socket.emit('join', name);
			  window.location.href = `http://142.93.164.123:3000/auth/game?name=${name}`;
			}

			socket.on('request', () => {
			  const name = window.location.search.split('=')[1];
        window.location.href = `http://142.93.164.123:3000/auth/game?name=${name}`;
			});

			socket.on('userList', (users) => {
			  userList.innerHTML = '';
			  users = users.usernames;
        for (var i = 0; i < users.length; i++) {
          const li = document.createElement('li');
          li.innerText = users;
          userList.appendChild(li);
          console.log(li);
        } 
			 });
		</script>
	</body>
</html>
